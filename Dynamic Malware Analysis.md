
## Port Monitoring using TCPView and CurrPorts

**TCPView** TCPView is a Windows program that shows the detailed listings of all the TCP and UDP endpoints on the system, including the local and remote addresses, and the state of the TCP connections. It provides a subset of the Netstat program that ships with Windows. The TCPView download includes Tcpvcon, a command-line version with the same functionality. When TCPView runs, it enumerates all active TCP and UDP endpoints, resolving all IP addresses to their domain name versions.

**CurrPorts** CurrPorts is a piece of network monitoring software that displays a list of all the currently open TCP/IP and UDP ports on a local computer. For each port in the list, information about the process that opened the port is also displayed, including the process name, full path of the process, version information of the process (product name, file description, etc.), the time that the process was created, and the user that created it.

**TCPView**  
  
In the machine, find njRAT and double-click **njRAT v0.8d.exe** to launch **njRAT**
  
A **[Port Now]** pop-up appears, leave the port number to default and click on **OK****

The njRAT GUI appears; click the **Build** link located in the lower-left corner of the GUI to configure the exploit details

The **Builder** dialog-box appears; enter the IP address of the **Windows 11** (attacker machine) machine in the **Host** field, rename **ExeName** as **Trojan.exe**. Leave the other settings to default, and click **Build**
In this task, the IP address of the **Windows 11** machine is **10.10.1.11**

**Save As** window appears, . In the **File name**, enter **Trojan.exe** and click **Save**. **Done!** pop-up appears, click **OK**
  
Minimize njRAT window. You can observe that a **Trojan.exe** file has been created at the location 

Click to switch to the machine. 

Navigate to the Path and execute **Trojan.exe**

Observe that a connection has been established by the njRAT client. Switch to **njRAT** window to observe the established connection

Now, let us analyze this process  using **TCPView** tool.

Navigate to TCPView and double-click **tcpview.exe** to launch the application
  
If a **TCPView License Agreement** window appears, click the **Agree** button to agree to the terms and conditions

The **TCPView** main window appears, displaying the details such as Process Name, Process ID, Protocol, State, Local Address, Local Port, Remote Address, Remote Port, as shown in the screenshot

TCPView performs **Port monitoring**. Click the **Local Port** tab to view the ports in serial order

Observe the protocols running on different ports under the **Protocol** column

As you have executed a malicious application, now search for the **Trojan.exe** process in the TCPView

You can observe that the **Trojan.exe** malicious program is running on the victim machine. You can see details such as **Remote Address** and **Remote Port**.

You can right-click the process **Trojan.exe**; select **Kill Process…** to end the running process

For this task, do not Kill the process in this step as we are going to use this running process for the next task; click **Cancel**. 
Normally, if a **TCPView** dialog box appears, click **OK** to terminate the process.
  
This way, you can view all processes running on the machine and stop unwanted or malicious processes that may affect your system. If you are unable to stop a process, you can view the port on which it is running and add a firewall rule to block the port

Close the **TCPView** window

**CurrPorts**

Now, let us analyze this process using **CurrPorts**

Navigate to CurrPorts** and double-click **cports.exe**

The **CurrPorts** window appears, displaying a list of currently open TCP/IP and UDP ports on the machine.
  
Scroll-down to search for **Trojan.exe** process running on the machine, as the shown in the screenshot. It is evident from the above screenshot that the process is connected to the machine on **port 5553**.

You can view the properties of the process by right-clicking on the process and clicking **Properties** from the **Context** menu

The **Properties** window appears, displaying information related to the process such as the name of the process, its process ID, Remote Address, Process Path, Remote Host Name, and other details.

Once you are done examining the properties associated with the process, click **OK**.

Because **Trojan.exe** is a malicious process, you may end the process by right-clicking on it and selecting **Kill Processes Of Selected Ports** from the context menu.

Alternatively, you may select **Close Selected TCP Connections**, so that the port closes, and the attacker can never regain connection through the port unless you open it.

Do not Kill the process at this step, as this running process will be used for the next task; when the **CurrPorts** dialog-box appears click **No**.
Normally, when the **CurrPorts** dialog-box appears, you would click **Yes** to close the connection.

Use other port monitoring tools such as **TCP Port/Telnet Monitoring** (https://www.dotcom-monitor.com), **PRTG Network Monitor** (https://www.paessler.com), **SolarWinds Open Port Scanner** (https://www.solarwinds.com) or to perform port monitoring.



